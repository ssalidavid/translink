document.getElementById('login').onsubmit = login_submit;
           
function login_submit(e){
    e.preventDefault();
    //Form Validation
    var emm = document.forms.loginForm.member_id.value;
    var pwm = document.forms.loginForm.password.value;

    if(emm == ""){
      document.getElementById("ers").innerHTML = "Member ID is required!";
        
    }else if(pwm == 0){
      document.getElementById("ers").innerHTML = "Password is required!";
    }else{
        another();
    } 
}
                        
function another(){
    var xhr = new XMLHttpRequest();
    var url = base_url+"admin/login/check_login";
    var em = document.forms.loginForm.member_id.value;
    var pw = document.forms.loginForm.password.value;
    var cridentials = "member_id="+em+"&password="+pw;
    
    xhr.open("POST",url,true);
    xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    
    xhr.onreadystatechange = function(){
        if(this.readyState == 4 && this.status == 200){
            
            if(this.responseText == 'not_auth'){
              document.getElementById("ers").innerHTML = "You are not Authorised to Access";
            }else if(this.responseText == 'wrong'){
              document.getElementById("ers").innerHTML = "Wrong Member ID or Password. Try again";
            }else{
              var lc = base_url+"admin/dashboard"; 
              window.location.assign(lc);    
            }
        }
    }

    xhr.send(cridentials);
}

// remember me on loging script;
$(document).ready(function() {
    var remember = $.cookie('remember');
    if (remember == 'true') {
        var username = $.cookie('member_id');
        var password = $.cookie('password');
        // autofill the fields
        $('#member_id').val(username);
        $('#password').val(password);
        $('#remember').attr('check checkbox id..checked',true);
    }

    $("#login").submit(function() {
        if ($('#remember').is(':checked')) {
            var username = $('#member_id').val();
            var password = $('#password').val();

            // set cookies to expire in 14 days
            $.cookie('member_id', username, { expires: 14 });
            $.cookie('password', password, { expires: 14 });
            $.cookie('remember', true, { expires: 14 });                
        }else{
            // reset cookies
            $.cookie('member_id', null);
            $.cookie('password', null);
            $.cookie('remember', null);
        }
    });
});